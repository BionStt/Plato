@model EditModeratorViewModel

<card>
    <card-title>
        @if (Model.IsNewModerator)
        {
        <h6 class="card-title">@T["Add Moderator"]</h6>
        }
        else
        {
        <h6 class="card-title">@T["Edit Moderator"]</h6>
        }
    </card-title>
    <card-body>


            @*<div class="form-group" asp-validation-class-for="Name">
            <label asp-for="Moderator.UserId"><strong>@T["Name"]</strong></label>
            <span asp-validation-for="Moderator.UserId" class="text-danger"></span>

            <div class="dropdown">
                <input placeholder="@T["name your channel"]" asp-for="Moderator.UserId" class="form-control" type="text"
                       data-provide="autoComplete"
                       data-autocomplete-url="api/users/search?page={page}&pageSize={pageSize}"
                       data-autocomplete-value-field="username" />
                <div class="dropdown-menu col-12" role="menu">
                    <p class="text-center">
                        <i class="fal fa-spinner fa-spin"></i>
                    </p>
                </div>
            </div>

        </div>*@

        <div class="form-group" asp-validation-class-for="Users">
            <fieldset>
                <input asp-for="Users" type="text" id="tagItStore" />
                <hr />
                <label asp-for="UserId">
                    <strong>@T["Username"]</strong>
                    <span asp-validation-for="Users" class="text-danger"></span><br />
                    <span class="text-muted">@T["Find a user to add as a moderator..."]</span>
                </label>
                <div class="dropdown">
                    <ul class="tagit form-control list-inline" data-provide="tagIt" data-tagit-store="#tagItStore">
                        <li class="tagit-list-item-input">
                            <input type="text"
                                   autocomplete="off"
                                   data-autocomplete-target="#moderators"
                                   data-autocomplete-url="api/users/search?page={page}&pageSize=5&username={username}"
                                   data-autocomplete-value-field="username"
                                   placeholder="@T["Search by username or email..."]">
                        </li>
                    </ul>
                    <div id="moderators" class="dropdown-menu col-12" role="menu">
                        <p class="text-center">
                            <i class="fal fa-spinner fa-spin"></i>
                        </p>
                    </div>
                </div>
            </fieldset>
        </div>

        <div class="form-group" asp-validation-class-for="EditAnyPost">


            <fieldset>
                @foreach (var category in Model.CategorizedPermissions.Keys)
                {
                    <fieldset class="role-permissions">

                        <table class="table">
                            <thead>
                            <tr>
                                <th colspan="3" class="col-12 bg-light">
                                    <h6>@category</h6>
                                </th>
                            </tr>
                            </thead>
                            <tbody>

                            <tr>
                                <td class="col-10 font-weight-bold">@T["Permission"]</td>
                                <td class="col-1 font-weight-bold text-center">@T["Allow"]</td>
                                <td class="col-1 font-weight-bold text-center">@T["Effective"]</td>
                            </tr>

                            @foreach (var permission in Model.CategorizedPermissions[category])
                            {

                                <tr data-text="@permission.Description">
                                    <td class="col-10">@permission.Description</td>
                                    <td class="col-1 text-center">
                                        <label>
                                            <span class="switch switch-round">
                                                <input class="form-check-input" type="checkbox" value="true" name="Checkbox.@permission.Name" checked="@(Model.Moderator?.Claims?.Any(x => x.ClaimValue == permission.Name))" />
                                                <span class="switch-slider"></span>
                                            </span>
                                        </label>
                                    </td>
                                    <td class="col-1 text-center">

                                        <label>
                                            <span class="switch switch-round switch-disabled">
                                                <input type="checkbox" disabled="disabled" name="Effective.@permission.Name" checked="@(Model.EnabledPermissions.Contains(permission.Name))" />
                                                <span class="switch-slider"></span>
                                            </span>
                                        </label>
                                    </td>
                                </tr>
                            }
                            </tbody>
                        </table>
                    </fieldset>
                }
            </fieldset>
                
        </div>
  
    </card-body>
</card>
