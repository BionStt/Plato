if(typeof jQuery=="undefined")throw new Error("jQuery 3.3.1 or above Required");if(typeof window.$.Plato=="undefined")throw new Error("$.Plato Required");if(typeof window.$.fn.platoUI=="undefined")throw new Error("$.Plato UI Required");$(function(n,t,i){"use strict";var r=n.$.Plato,u=function(){var n="reactions",u=n+"Id",f={tooltipEvent:"mouseenter",event:"click",params:{id:0,userId:0,entityId:0,entityReplyId:0,reactionName:""},data:{}},t={init:function(n,i){if(i){this[i]?this[i].apply(this,[n]):alert(i+" is not a valid method!");return}t.bind(n)},bind:function(r){r.find("a").each(function(){var u="";i(this).attr("data-toggle")?i(this).tooltip({trigger:"hover"}):(u=r.data(n).tooltipEvent,u&&i(this).unbind(u).bind(u,function(){var n=i(this).attr("data-reaction-description");n&&r.find(".text-muted").text(n)}));u=r.data(n).event;u&&i(this).unbind(u).bind(u,function(u){u.preventDefault();i(this).attr("data-toggle")&&i(this).tooltip("hide");r.data(n).params.reactionName=i(this).attr("data-reaction-name");t.post(r)})})},unbind:function(t){t.find("a").each(function(){var r=t.data(n).tooltipEvent;r&&i(this).unbind(r);r=t.data(n).event;r&&i(this).unbind(r)})},post:function(i){var u=i.data(n).params;u.entityId=this.getEntityId(i);u.entityReplyId=this.getEntityReplyId(i);r.http({url:"api/reactions/react/post",method:"POST",data:JSON.stringify(u)}).done(function(r){(r.statusCode===201||r.statusCode===202)&&r.result&&(i.data(n).data=r.result,t.refresh(i))})},refresh:function(r){var o=r.data(n).data,u=this.getTarget(r),f;if(u){if(u.empty(),o.length>0){for(f=0;f<o.length;f++){var e=o[f],s=i("<li>",{"class":"list-group-item  border-0"}),h=i("<a>",{href:"#","class":"list-group-item list-group-item-action py-2 px-3 border-0","data-toggle":"tooltip",title:e.toolTip,"data-reaction-name":e.name}),c=i("<span>",{"class":"d-inline-block mx-1"}).html(e.emoji),l=i("<span>",{"class":"d-inline-block mx-1"}).html(e.total);h.append(c).append(l);s.append(h);u.append(s)}u.hasClass("hidden")&&u.removeClass("hidden")}else u.hasClass("hidden")||u.addClass("hidden");t.bind(u)}},getEntityId:function(n){var t=0;if(n.attr("data-entity-id")&&(t=parseInt(n.attr("data-entity-id"))),t===0)throw new Error("A entity id is required in order to react to an entity");return t},getEntityReplyId:function(n){var t=0;return n.attr("data-entity-reply-id")&&(t=parseInt(n.attr("data-entity-reply-id"))),t},getTarget:function(n){var r=n.attr("data-reactions-target"),t;return r&&(t=i(r),t.length>0)?t:null}};return{init:function(){for(var e,h,o={},r=null,s=0;s<arguments.length;++s)if(e=arguments[s],e)switch(e.constructor){case Object:i.extend(o,e);break;case String:r=e}if(this.length>0)return this.each(function(){if(i(this).data(u))i(this).data(n,i.extend({},i(this).data(n),o));else{var e=n+parseInt(Math.random()*100)+(new Date).getTime();i(this).data(u,e);i(this).data(n,i.extend({},f,o))}t.init(i(this),r)});r&&(t[r]?(h=i("body"),h.data(n,i.extend({},f,o)),t[r].apply(this,[h])):alert(r+" is not a valid method!"))}}}();i.fn.extend({reactions:u.init});r.ready(function(){i('[data-provide="reactions"]').reactions()});i().infiniteScroll(function(n){n.find('[data-provide="reactions"]').reactions()},"ready")}(window,document,jQuery));