if(typeof jQuery=="undefined")throw new Error("Plato requires jQuery");$(function(n,t,i){"use strict";n.$.Plato={};n.$.Plato.Options={debug:!1,url:"",locale:"en-US",apiKey:"",csrfHeaderName:"X-Csrf-Token",csrfCookieName:"",BSToolTipEnabled:!0,BSToolTipAlternativeSelector:"[data-provide='tooltip']",BSToolTipSelector:"[data-toggle='tooltip']",MagnificSelector:"[data-toggle='dialog']",AvatarUploadSelector:"[data-upload='avatar']",getCsrfCookieToken:function(){if(this.csrfCookieName!==""){var i=n.$.Plato.Storage,t=i.getCookie(this.csrfCookieName);if(t)return t}return""}};n.$.Plato.Logger={info:"Info",warning:"Warning",error:"Error",prevLogDate:null,logInfo:function(n){this.log(this.info,n)},logWarning:function(n){this.log(this.warning,n)},logError:function(n){this.log(this.error,n)},log:function(n,t){if(i.Plato.Options.debug){var r=this.getDifferenceInMilliseconds();this.prevLogDate=new Date;console.log(n+": "+t+" - "+r+"ms elapsed since previous log entry.")}},getDifferenceInMilliseconds:function(){if(this.prevLogDate===null)this.prevLogDate=new Date;else return(this.prevLogDate-new Date)/1e4;return 0}};n.$.Plato.Locale={init:function(){var t=n.$.Plato.Context,i,r,u;if(!t)throw new Error("Plato.Locale requires a valid Plato.Context object");if(i=t.options(),!i)throw new Error("$.Plato.Locale requires a valid $.Plato.Options object");if(t.logger.logInfo("Initializing $.Plato.Locale"),i.locale===""){t.logger.logError("$.Plato.Locale could not be initialized as the $.Plato.Options.locale property is empty!");return}if(i.url===""){t.logger.logError("$.Plato.Locale could not be initialized as the $.Plato.Options.url property is empty!");return}r=i.url;r.substring(r.length-1,r.length)!=="/"&&(r+="/");u=r+"js/app/locale/app."+i.locale+".js";t.logger.logInfo("Loading locale: "+u);this._load(u)},get:function(t){var i=n.$.Plato.Strings;return typeof i!="undefined"&&typeof i[t]!="undefined"?i[t]:t},_load:function(t){var r=n.$.Plato.Context,u=document.getElementsByTagName("head"),f=parseInt(Math.random()*1e3)+(new Date).getTime(),i=document.createElement("script");i.setAttribute("src",t+"?v="+f);u&&(u[0].appendChild(i),r.logger.logInfo("Adding locale ("+t+") to the head element."));i.onLoad=function(){r.logger.logInfo("Added locale ("+t+") to the head element.")}}};n.$.Plato.Context={options:function(){return typeof PlatoOptions!="undefined"&&i.extend(!0,i.Plato.Options,window.PlatoOptions),i.Plato.Options},logger:i.Plato.Logger,localizer:i.Plato.Locale};n.$.Plato.UI={context:n.$.Plato.Context,init:function(n){n||(n=i("body"));this.initToolTips(n);this.initDropDowns(n);this.initAvatar(n)},logInfo:function(n){this.context.logger.logInfo(n)},logError:function(n){this.context.logger.logError(n)},initToolTips:function(n){n||(n=i("body"));this.logInfo("initToolTips()");this.context.options().BSToolTipEnabled&&(n&&(n.find(this.context.options().BSToolTipSelector).tooltip({trigger:"hover"}),n.find(this.context.options().BSToolTipAlternativeSelector).tooltip({trigger:"hover"})),this.logInfo("Bootstratp tooltipss initialized."))},initDropDowns:function(n){n||(n=i("body"));this.logInfo("initDropDowns()");n.find("ul.dropdown-menu [data-toggle='dropdown']").on("click",function(n){n.preventDefault();n.stopPropagation();i("ul.dropdown-menu [data-toggle='dropdown']").parent().removeClass("show");i(this).parent().addClass("show")})},initAvatar:function(n){n||(n=i("body"));this.logInfo("initAvatar()");n.find(this.context.options().AvatarUploadSelector).change(function(){function n(n){if(n.files&&n.files[0]){var t=new FileReader;t.onload=function(t){var u=i(n).attr("data-upload-preview-selector"),r=i(u).find("span");r.css("background-image"," url("+t.target.result+")");r.hide().fadeIn(650)};t.readAsDataURL(n.files[0])}}n(this)})},notify:function(n,t){i.notify(n,t)}};n.$.Plato.Http=function(t){var r=n.$.Plato.Context,s,f,u,e,o,h;if(!r)throw new Error("$.Plato.Http requires a valid Plato.Context object");if(s=n.$.Plato.UI,!s)throw new Error("$.Plato.Http requires a valid $.Plato.UI object");if(f=r.options(),!f)throw new Error("$.Plato.Http requires a valid $.Plato.Options object");return u=f.url,e=t.url,u.substring(u.length-1,u.length)==="/"&&(u=u.substring(f.url.length-1)),e.substring(0,1)!=="/"&&(e="/"+e),t.url=u+e,o=f.apiKey,o?(r.logger.logInfo("ApiKey: "+o),t.beforeSend=function(n){n.setRequestHeader("Authorization","Basic "+o)}):r.logger.logInfo("No api key was supplied"),t.headers={"Content-Type":"application/json","X-Api-Version":"1","X-Csrf-Token":f.getCsrfCookieToken()},h=function(){var f=function(n){var t="<h6>"+r.localizer.get("An error occurred!")+"<\/h6>";return t+=r.localizer.get("Information is provided below...")+"<br/><br/>",t+('<textarea style="min-height: 130px;" class="form-control">'+n+"<\/textarea>")},n=function(n){s.notify({message:n},{mouse_over:"pause",type:"danger",allow_dismiss:!0})},t=function(t,i,u,e){var o="$.Plato.Http - "+e+"\n"+JSON.stringify(i,null,"     ");r.logger.logError(o);n(f(o))},u=function(t){t.statusCode===401&&n("<h6>"+r.localizer.get("Could not authenticate your request!")+"<\/h6>");r.logger.logInfo("$.Plato.Http - Completed: "+JSON.stringify(t,null,"     "))};return{promise:function(n){return i.ajax(n).fail(function(i,r,u){t&&t(n,i,r,u)}).always(function(n,t){u&&u(n,t)})}}}(),r.logger.logInfo("$.Plato.Http - Starting Request: "+JSON.stringify(t,null,"     ")),h.promise(t)};n.$.Plato.Storage={setCookie:function(n,t,i,r,u){var e,f;return r=r||!1,r&&(t=encodeURIComponent(JSON.stringify(t))),u||(u="/"),e="",i&&(f=new Date,f.setTime(f.getTime()+864e5*i),e="; expires="+f.toGMTString()),document.cookie=n+"="+t+e+";path="+u,this},getCookie:function(n){var r=n+"=",u=document.cookie.indexOf(r),i,t;return u!==-1?(i=u+r.length,t=document.cookie.indexOf(";",i),t===-1&&(t=document.cookie.length),unescape(document.cookie.substring(i,t))):null},updateCookie:function(n,t,i,r){var o=this.getCookie(n),f=[],u,e;if(r=r||",",o){u=o.split(r);for(e in u)u.hasOwnProperty(e)&&u[e]!==t&&u[e]!==""&&(f[f.length]=u[e])}return i&&(f[f.length]=t),this.setCookie(n,f.join(r)),this},clearCookie:function(n){return this.setCookie(n,null,-1),this}};n.$.Plato.Text={htmlEncode:function(n){var t=document.createElement("span");return t.textContent=n,t.innerHTML}};i(t).ready(function(){var t=n.$.Plato.Context;t.logger.logInfo("$.Plato.Options = "+JSON.stringify(t.options(),null,"     "));n.$.Plato.UI.init();n.$.Plato.Locale.init()})}(window,document,jQuery));