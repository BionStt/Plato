if(typeof $().modal=="undefined")throw new Error("BootStrap 4.1.1 or above Required");if(typeof window.$.Plato=="undefined")throw new Error("$.Plato Required");$(function(n,t,i){"use strict";var r=n.$.Plato,u=function(){var n="history",u=n+"Id",f={entityId:0,entityReplyId:0,dialogUrl:null},t={init:function(n,t){if(t){this[t]?this[t].apply(this,[n]):alert(t+" is not a valid method!");return}this.bind(n)},bind:function(n){var e=this.getEntityId(n),o=this.getEntityReplyId(n),u=this.getDialogUrl(n),t="?page={page}&size={pageSize}&entityId={entityId}&entityReplyId={entityReplyId}",f;if(u===null)throw new Error("The history menu requires a data-dialog-url attribute");t=t.replace(/\{entityId}/g,e);t=t.replace(/\{entityReplyId}/g,o);f=r.T("No history available");n.pagedList({page:1,pageSize:50,enablePaging:!0,loaderTemplate:null,itemSelection:{enable:!1,index:0,css:"active"},noResultsIcon:null,noResultsText:f,config:{method:"GET",url:"api/history/entity/get"+t,data:{sort:"CreatedDate",order:1}},itemCss:"dropdown-item p-2",itemTemplate:'<a data-history-id="{id}" class="{itemCss}" href="{url}"><span class="list-left list-left-sm"><span class="avatar avatar-sm" data-toggle="tooltip" title="{createdBy.displayName}"><span style="background-image: url({createdBy.avatar.url}"><\/span><\/span><\/span><span class="list-body"><span class="float-right">{version}<\/span>{text}<\/span><\/a>',parseItemTemplate:function(n,t){return n=t.id?n.replace(/\{id}/g,t.id):n.replace(/\{id}/g,"0"),n=t.text?n.replace(/\{text}/g,t.text):n.replace(/\{text}/g,""),n=t.version?n.replace(/\{version}/g,t.version):n.replace(/\{version}/g,""),n=t.createdBy.id?n.replace(/\{createdBy.id}/g,t.createdBy.id):n.replace(/\{createdBy.id}/g,""),n=t.createdBy.displayName?n.replace(/\{createdBy.displayName}/g,t.createdBy.displayName):n.replace(/\{createdBy.displayName}/g,""),n=t.createdBy.url?n.replace(/\{createdBy.url}/g,t.createdBy.url):n.replace(/\{createdBy.url}/g,""),n=t.createdBy.avatar.url?n.replace(/\{createdBy.avatar.url}/g,t.createdBy.avatar.url):n.replace(/\{createdBy.avatar.url}/g,""),n=t.date.value?n.replace(/\{date.value}/g,t.date.value):n.replace(/\{date.value}/g,""),n.replace(/\{url}/g,u.replace("0",t.id))},onItemClick:function(n,t,r,u){r.preventDefault();r.stopPropagation();i().dialog({id:"historyDialog",body:{url:u.attr("href")},css:{modal:"modal fade",dialog:"modal-dialog modal-lg"}},"show")},onLoaded:function(){r.ui.initToolTips(n)}})},update:function(n){n.pagedList("unbind")},getEntityId:function(t){var r=typeof t.data("entityId")!="undefined"&&t.data("entityId")!==null?t.data("entityId"):t.data(n).entityId,i;return r!==null&&(i=parseInt(r),!isNaN(i))?i:0},getEntityReplyId:function(t){var r=typeof t.data("entityReplyId")!="undefined"&&t.data("entityReplyId")!==null?t.data("entityReplyId"):t.data(n).entityReplyId,i;return r!==null&&(i=parseInt(r),!isNaN(i))?i:0},getDialogUrl:function(t){return typeof t.data("dialogUrl")!="undefined"&&t.data("dialogUrl")!==null?t.data("dialogUrl"):t.data(n).dialogUrl}};return{init:function(){for(var e,h,o={},r=null,s=0;s<arguments.length;++s)if(e=arguments[s],e)switch(e.constructor){case Object:i.extend(o,e);break;case String:r=e}if(this.length>0)return this.each(function(){if(i(this).data(u))i(this).data(n,i.extend({},i(this).data(n),o));else{var e=n+parseInt(Math.random()*100)+(new Date).getTime();i(this).data(u,e);i(this).data(n,i.extend({},f,o))}t.init(i(this),r)});r&&(t[r]?(h=i("body"),h.data(n,i.extend({},f,o)),t[r].apply(this,[h])):alert(r+" is not a valid method!"))}}}(),f=function(){var n="historyDropdown",t=n+"Id",r={},u={init:function(n){this.bind(n)},bind:function(n){n.find(".dropdown-toggle").click(function(){n.find('[data-provide="history"]').history()})}};return{init:function(){var f={};return this.each(function(){if(i(this).data(t))i(this).data(n,i.extend({},i(this).data(n),f));else{var e=n+parseInt(Math.random()*1e3)+(new Date).getTime();i(this).data(t,e);i(this).data(n,i.extend({},r,f))}u.init(i(this))})}}}();i.fn.extend({history:u.init,historyDropdown:f.init});r.ready(function(){i('[data-provide="history-dropdown"]').historyDropdown()});i().infiniteScroll(function(n){n.find('[data-provide="history-dropdown"]').historyDropdown()},"ready")}(window,document,jQuery));