if(typeof jQuery=="undefined")throw new Error("jQuery 3.3.1 or above Required");if(typeof window.$.Plato=="undefined")throw new Error("$.Plato Required");if(typeof window.$.fn.platoUI=="undefined")throw new Error("$.Plato UI Required");$(function(n,t,i){"use strict";var r=n.$.Plato,u=function(){var n="rating",u=n+"Id",f={event:"click",params:{rating:0,entityId:0,entityReplyId:0},onUpdated:function(){}},t={_loading:!1,init:function(n,i){if(i){this[i]?this[i].apply(this,[n]):alert(i+" is not a valid method!");return}t.bind(n)},bind:function(r){r.find("a").each(function(){var u=r.data(n).event;u&&i(this).unbind(u).bind(u,function(u){var f=parseInt(i(this).attr("data-rating"));isNaN(f)||(u.preventDefault(),r.data(n).params.rating=f,t.post(r))})})},unbind:function(t){t.find("a").each(function(){var r=t.data(n).tooltipEvent;r&&i(this).unbind(r);r=t.data(n).event;r&&i(this).unbind(r)})},post:function(i){if(!t._loading){t._loading=!0;var u=i.data(n).params;u.entityId=this.getEntityId(i);u.entityReplyId=this.getEntityReplyId(i);r.http({url:t.getUrl(i),method:"POST",data:JSON.stringify(u)}).done(function(r){if((r.statusCode===201||r.statusCode===202)&&(t._loading=!1,i.data(n).onUpdated))i.data(n).onUpdated(i,r.result)})}},getUrl:function(n){return n.attr("data-rating-url")&&n.attr("data-rating-url")!==""?n.attr("data-rating-url"):"api/ratings/rate/post"},getEntityId:function(n){var t=0;if(n.attr("data-entity-id")&&(t=parseInt(n.attr("data-entity-id"))),t===0)throw new Error("A entity id is required in order to rate an entity");return t},getEntityReplyId:function(n){var t=0;return n.attr("data-entity-reply-id")&&(t=parseInt(n.attr("data-entity-reply-id"))),t}};return{init:function(){for(var e,h,o={},r=null,s=0;s<arguments.length;++s)if(e=arguments[s],e)switch(e.constructor){case Object:i.extend(o,e);break;case String:r=e}if(this.length>0)return this.each(function(){if(i(this).data(u))i(this).data(n,i.extend({},i(this).data(n),o));else{var e=n+parseInt(Math.random()*100)+(new Date).getTime();i(this).data(u,e);i(this).data(n,i.extend({},f,o))}t.init(i(this),r)});r&&(t[r]?(h=i("body"),h.data(n,i.extend({},f,o)),t[r].apply(this,[h])):alert(r+" is not a valid method!"))}}}(),f=function(n){var t="voteToggle",e=t+"Id",f={},u={init:function(n,t){if(t){this[t]?this[t].apply(this,[n]):alert(t+" is not a valid method!");return}u.bind(n)},bind:function(t){t.rating(i.extend({onUpdated:function(n,t){var i=n.find("h6"),u;if(i.length>0){if(u=t.totalRatings,u!==null&&typeof u!="undefined"){var f=r.T("Based on {0}"),e=r.T("vote"),o=r.T("votes"),s=u===1?u+" "+e:u+" "+o;f=f.replace("{0}",s);i.attr("title")&&i.attr("title",f);i.attr("data-original-title")&&i.attr("data-original-title",f)}i.empty().text(t.summedRating)}}},f,n))},unbind:function(n){n.rating("unbind")}};return{init:function(){for(var r,h,o={},n=null,s=0;s<arguments.length;++s)if(r=arguments[s],r)switch(r.constructor){case Object:i.extend(o,r);break;case String:n=r}if(this.length>0)return this.each(function(){if(i(this).data(e))i(this).data(t,i.extend({},i(this).data(t),o));else{var r=t+parseInt(Math.random()*100)+(new Date).getTime();i(this).data(e,r);i(this).data(t,i.extend({},f,o))}u.init(i(this),n)});n&&(u[n]?(h=i("body"),h.data(t,i.extend({},f,o)),u[n].apply(this,[h])):alert(n+" is not a valid method!"))}}}();i.fn.extend({rating:u.init,voteToggle:f.init});r.ready(function(){i('[data-provide="rating"]').rating();i('[data-provide="vote-toggle"]').voteToggle()});i().infiniteScroll(function(n){n.find('[data-provide="rating"]').rating();n.find('[data-provide="vote-toggle"]').voteToggle()},"ready")}(window,document,jQuery));